% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/prognostic_analysis.R
\name{find_prognostic_markers}
\alias{find_prognostic_markers}
\title{Find Unique Marker Genes for Adverse and Favorable Prognostic Groups}
\usage{
find_prognostic_markers(
  expression,
  group_labels,
  group_column = NULL,
  cell_id_column = "cell_id",
  assay = NULL,
  slot = "data",
  test.use = c("wilcox", "t", "roc", "negbinom", "poisson", "LR"),
  min.pct = 0.1,
  logfc.threshold = 0.25,
  pval_threshold = 0.05,
  verbose = TRUE,
  ...
)
}
\arguments{
\item{expression}{Expression matrix (genes x cells), a Seurat object, or a
SingleCellExperiment. Must match cells in \code{group_labels}.}

\item{group_labels}{Either a character vector of group labels
(\code{"adverse"}, \code{"favorable"}, \code{"middle"}) in the same order
as columns of \code{expression}, or a data.frame from
\code{define_prognostic_groups()} (see \code{group_column}).}

\item{group_column}{If \code{group_labels} is a data.frame, the name of the
column containing \code{"adverse"} / \code{"favorable"} / \code{"middle"}.}

\item{cell_id_column}{If \code{group_labels} is a data.frame, the column
name for cell/sample IDs (default \code{"cell_id"}).}

\item{assay}{Assay name for Seurat/SCE (e.g. \code{"RNA"}).}

\item{slot}{Layer for Seurat: \code{"data"}, \code{"counts"}, or
\code{"scale.data"} (default \code{"data"}).}

\item{test.use}{Seurat \code{test.use}: \code{"wilcox"} (default), \code{"t"},
\code{"roc"}, \code{"negbinom"}, \code{"poisson"}, or \code{"LR"}.}

\item{min.pct}{Minimum fraction of cells expressing the gene in either group
(default 0.1). Passed to \code{FindMarkers}.}

\item{logfc.threshold}{Minimum absolute log2 fold change (default 0.25).
Passed to \code{FindMarkers}.}

\item{pval_threshold}{Maximum unadjusted p-value to include (default 0.05).}

\item{verbose}{Print progress messages (default TRUE).}

\item{...}{Additional arguments passed to \code{Seurat::FindMarkers}.}
}
\value{
A list with:
\itemize{
\item \code{adverse_markers}: data.frame of genes that are markers of
the adverse (top score) group (vs rest).
\item \code{favorable_markers}: data.frame of genes that are markers of
the favorable (bottom score) group (vs rest).
}
Each data.frame has columns: \code{gene}, \code{avg_log2FC},
\code{pct_in_group}, \code{pct_rest}, \code{p_val}, \code{p_adj}.
}
\description{
Uses Seurat's \code{FindMarkers} to perform differential expression between
the top (adverse) and bottom (favorable) prognostic groups versus the rest.
Requires the Seurat package.
}
\examples{
\dontrun{
scores <- score_expression(seurat_obj, reference = "precog", cancer_type = "BRCA")
groups <- define_prognostic_groups(scores, percentile = 0.05)
markers <- find_prognostic_markers(
  seurat_obj,
  group_labels = groups,
  group_column = "prognostic_group_weighted_sum_score_precog_BRCA",
  cell_id_column = "cell_id"
)
head(markers$adverse_markers)
head(markers$favorable_markers)
}

}
